<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8"/>
<title>DbQuery - Multi Theft Auto: Wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"DbQuery","wgTitle":"DbQuery","wgCurRevisionId":46292,"wgRevisionId":46292,"wgArticleId":5886,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Server functions"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"DbQuery","wgRelevantArticleId":5886,"wgRequestId":"2e0b524dd6e9873286b1d68a","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgWikiEditorEnabledModules":{"toolbar":false,"dialogs":false,"preview":false,"publish":false}});mw.loader.implement("user.options",function($,jQuery,require,module){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function ( $, jQuery, require, module ) {
mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});/*@nomin*/;

});mw.loader.load(["mediawiki.page.startup"]);});</script>
<link rel="stylesheet" href="http://wiki.localhost/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.content.externallinks%7Cmediawiki.skinning.interface%7Cskins.monobook.styles&amp;only=styles&amp;skin=monobook"/>
<!--[if IE 6]><link rel="stylesheet" href="/skins/MonoBook/IE60Fixes.css?303" media="screen"/><![endif]--><!--[if IE 7]><link rel="stylesheet" href="/skins/MonoBook/IE70Fixes.css?303" media="screen"/><![endif]-->
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="http://wiki.localhost/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=monobook"/>
<script async="" src="http://wiki.localhost/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=monobook"></script>
<meta name="generator" content="MediaWiki 1.27.5"/>
<link rel="shortcut icon" href="http://wiki.localhost/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="http://wiki.localhost/opensearch_desc.php" title="Multi Theft Auto: Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.multitheftauto.com/api.php?action=rsd"/>
<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html"/>
<link rel="alternate" type="application/atom+xml" title="Multi Theft Auto: Wiki Atom feed" href="http://wiki.localhost/index.php?title=Special:RecentChanges&amp;feed=atom"/>
<meta name='headingclass' content='' data-class='server' data-subcaption='Server-only function'>
<meta name='lowercasetitle' content=''>
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-DbQuery rootpage-DbQuery skin-monobook action-view">
<div id="globalWrapper">
		<div id="column-content">
			<div id="content" class="mw-body" role="main">
				<a id="top"></a>
				
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">DbQuery</h1>
				
				<div id="bodyContent" class="mw-body-content">
					<div id="siteSub">From Multi Theft Auto: Wiki</div>
					<div id="contentSub"></div>
										<div id="jump-to-nav" class="mw-jump">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>

					<!-- start content -->
					<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><p><!--HC-->
<!--LC-->
This function starts a database query using the supplied connection. Use the returned query handle with <a href="DbPoll.html" title="DbPoll">dbPoll</a> to get the result, or <a href="DbFree.html" title="DbFree">dbFree</a> if you don't want the result.
</p>
<table cellspacing="0" style="padding: 5px; width: 80%; margin: 2px auto 2px auto; border: 1px solid #81C687; background: #E2FFE5; border-left: 10px solid #81C687;">
<tr>
<td style="width: 32px; vertical-align:top; display: none;" rowspan="2"> [[{{{image}}}|link=]]
</td>
<td style=""> <b>Tip:</b> The server command <a href="Server_Commands.html#debugdb" title="Server Commands">debugdb 2</a> will output verbose information on each query to a logging file (usually <b>logs/db.log</b>)
</td></tr>
<tr>
<td rowspan="1" style="padding-left: 10px;">
</td></tr></table>
<h2><span class="mw-headline" id="Syntax">Syntax</span></h2>
<pre class="prettyprint lang-lua">
handle dbQuery ( [ function callbackFunction, [ table callbackArguments, ] ] element databaseConnection, string query [, var param1 [, var param2 ...]] )
</pre>
<p><u><b>OOP Syntax</b></u> <small><a href="OOP_Introduction.html" title="OOP Introduction">Help! I don't understand this!</a></small>
</p>
<dl><dd> <b>Method</b>: <i><a href="Connection.html" title="Connection">connection</a>:query(...)</i></dd></dl>
<h3><span class="mw-headline" id="Required_Arguments">Required Arguments</span></h3>
<ul><li><b>databaseConnection:</b> A database connection element previously returned from <a href="DbConnect.html" title="DbConnect">dbConnect</a></li>
<li><b>query:</b> An SQL query. Positions where parameter values will be inserted are marked with a <b>?</b></li></ul>
<h3><span class="mw-headline" id="Optional_Arguments">Optional Arguments</span></h3>
<ul><li><b>callbackFunction:</b> An optional function to be called when a result is ready. The function will only be called if the result has not already been read with <a href="DbPoll.html" title="DbPoll">dbPoll</a>. The function is called with the query handle as the first argument. (Notice: Do not use a function with a local prefix)</li>
<li><b>callbackArguments:</b> An optional table containing extra arguments to be sent to the callback function.</li>
<li><b>paramX:</b> A variable number of parameters. These must be strings or numbers - it is important to make sure they are of the correct type. Also, the number of parameters passed must be equal to the number of <b>?</b> characters in the query string.</li></ul>
<p>String parameters are automatically quoted and escaped as required. (If you do not want a string quoted, use <b>??</b>)
</p>
<h3><span class="mw-headline" id="Returns">Returns</span></h3>
<p>Returns a query handle unless the connection is incorrect, in which case it return <i>false</i>.
</p>
<h2><span class="mw-headline" id="Example">Example</span></h2>
<p>This example starts an INSERT query and frees the result:
</p>
<pre class="prettyprint lang-lua">
local qh = dbQuery( connection, "INSERT INTO table_name VALUES (?,?,?)", "aaa", "bbb", 10 )
dbFree( qh )
</pre>
<p><br />
This example starts a select query and waits for the result: (server freeze included)
</p>
<pre class="prettyprint lang-lua">
local qh = dbQuery( connection, "SELECT * FROM table_name" )
local result = dbPoll( qh, -1 )
</pre>
<p><br />
This example starts a select query and processes the result in a callback function:
</p>
<pre class="prettyprint lang-lua">
function aaa()
    dbQuery( myCallback, connection, "SELECT * FROM table_name" )
end

function myCallback(qh)
    local result = dbPoll( qh, 0 )   -- Timeout doesn't matter here because the result will always be ready
end
</pre>
<p><br />
This example starts a select query and processes the result in an inline callback function with custom arguments:
</p>
<pre class="prettyprint lang-lua">
dbQuery( function(qh, tag, score)
            local result = dbPoll( qh, 0 )   -- Timeout doesn't matter here because the result will always be ready
            outputDebugString( tag )         -- Prints "hello"
            outputDebugString( score )       -- Prints 2000
         end
         ,{"hello",2000}, connection, "SELECT * FROM table_name" )
</pre>
<p><br />
<i><b>Note</b>: It is usually good practice to surround table and column names with backticks (`) in case they contain spaces or SQL keywords (and therefore cause syntax errors). This is especially true when using variables for table and column names, as potential problems may not be apparent when the script is first written.</i><br />
</p><p>This example shows how to use backticks and <b>??</b> for parts of the query that are not column values:
</p>
<pre class="prettyprint lang-lua">
dbExec( connection, "UPDATE `??` SET `??`=?", tableName, columnName, columnValue )
</pre>
<h2><span class="mw-headline" id="Requirements">Requirements</span></h2>
<table cellpadding="4" style="border-collapse: collapse; border-width: 1px; border-style: solid; border-color: #FFF">

<tr>
<th style="background-color: #FFAA44; border-style: solid; border-width: 1px; border-color: #FFF; color:#7A4A20"> Minimum supported server
</th>
<th width="60" style="white-space: nowrap; background-color: #FFCC66; border-style: solid; border-width: 1px; border-color: #FFF"> 1.1.1-9.03328
</th></tr>
<tr>
<th style="background-color: #FF6666; border-style: solid; border-width: 1px; border-color: #FFF; color:#AA0028"> Minimum supported client
</th>
<th style="white-space: nowrap; background-color: #FFBBBB; border-style: solid; border-width: 1px; border-color: #FFF"> n/a
</th></tr></table>Note: Using this function requires the resource to have the above minimum version declared in the <a href="Meta.html" title="Meta.xml">meta.xml</a> <b>&lt;min_mta_version&gt;</b> section. <i>e.g. &lt;min_mta_version server="1.1.1-9.03328"  /&gt;</i>
<h2><span class="mw-headline" id="See_Also">See Also</span></h2>
<ul><li><a href="ExecuteSQLQuery.html" title="ExecuteSQLQuery">executeSQLQuery</a></li>
<li><a href="DbConnect.html" title="DbConnect">dbConnect</a></li>
<li><a href="DbExec.html" title="DbExec">dbExec</a></li>
<li><a href="DbFree.html" title="DbFree">dbFree</a></li>
<li><a href="DbPoll.html" title="DbPoll">dbPoll</a></li>
<li><a href="DbPrepareString.html" title="DbPrepareString">dbPrepareString</a></li>
<li><strong class="selflink">dbQuery</strong></li></ul>
<p><br />
</p>
<!-- 
NewPP limit report
Cached time: 20190625164231
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.010 seconds
Real time usage: 0.011 seconds
Preprocessor visited node count: 172/1000000
Preprocessor generated node count: 721/1000000
Postâ€expand include size: 2455/2097152 bytes
Template argument size: 587/2097152 bytes
Highest expansion depth: 5/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    5.845      1 - -total
 35.26%    2.061      1 - Template:Tip
 24.79%    1.449      1 - Template:MessageBox
 15.28%    0.893      1 - Template:Requirements
 14.70%    0.859      1 - Template:OOP
 13.82%    0.808      1 - Template:Server_function
  8.33%    0.487      1 - Template:SQL_functions
-->

<!-- Saved in parser cache with key mta_wiki-wiki_dev_:pcache:idhash:5886-0!*!0!!*!*!* and timestamp 20190625164231 and revision id 46292
 -->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="https://wiki.multitheftauto.com/index.php?title=DbQuery&amp;oldid=46292">https://wiki.multitheftauto.com/index.php?title=DbQuery&amp;oldid=46292</a>"</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="Special_Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="Category_Server_functions.html" title="Category:Server functions">Server functions</a></li></ul></div></div>					<!-- end content -->
										<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div id="column-one">
			<h2>Navigation menu</h2>
					<div id="p-cactions" class="portlet" role="navigation">
			<h3>Views</h3>

			<div class="pBody">
				<ul>
				<li id="ca-nstab-main" class="selected"><a href="DbQuery.html" title="View the content page [c]" accesskey="c">Page</a></li>
				<li id="ca-talk" class="new"><a href="http://wiki.localhost/index.php?title=Talk:DbQuery&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				<li id="ca-viewsource"><a href="http://wiki.localhost/index.php?title=DbQuery&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li>
				<li id="ca-history"><a href="http://wiki.localhost/index.php?title=DbQuery&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li>
				</ul>
							</div>
		</div>
				<div class="portlet" id="p-personal" role="navigation">
				<h3>Personal tools</h3>

				<div class="pBody">
					<ul>
													<li id="pt-createaccount"><a href="http://wiki.localhost/index.php?title=Special:CreateAccount&amp;returnto=DbQuery" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li>
													<li id="pt-login"><a href="http://wiki.localhost/index.php?title=Special:UserLogin&amp;returnto=DbQuery" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
											</ul>
				</div>
			</div>
			<div class="portlet" id="p-logo" role="banner">
				<a href="Main_Page.html" class="mw-wiki-logo" title="Visit the main page"></a>
			</div>
				<div class="generated-sidebar portlet" id="p-navigation" role="navigation">
		<h3>Navigation</h3>
		<div class='pBody'>
							<ul>
											<li id="n-Home"><a href="Main_Page.html">Home</a></li>
											<li id="n-How-you-can-help"><a href="How_you_can_help.html">How you can help</a></li>
											<li id="n-recentchanges"><a href="Special_RecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
											<li id="n-randompage"><a href="Special_Random" title="Load a random page [x]" accesskey="x">Random page</a></li>
									</ul>
					</div>
		</div>
		<div class="generated-sidebar portlet" id="p-reference" role="navigation">
		<h3>reference</h3>
		<div class='pBody'>
							<ul>
											<li id="n-Client-Functions"><a href="Client_Scripting_Functions.html">Client Functions</a></li>
											<li id="n-Client-Events"><a href="Client_Scripting_Events.html">Client Events</a></li>
											<li id="n-Server-Functions"><a href="Server_Scripting_Functions.html">Server Functions</a></li>
											<li id="n-Server-Events"><a href="Server_Scripting_Events.html">Server Events</a></li>
											<li id="n-Shared-Functions"><a href="Shared_Scripting_Functions.html">Shared Functions</a></li>
											<li id="n-Useful-Functions"><a href="Useful_Functions.html">Useful Functions</a></li>
											<li id="n-MTA-Classes"><a href="MTA_Classes.html">MTA Classes</a></li>
											<li id="n-MTA-Elements"><a href="Element.html">MTA Elements</a></li>
											<li id="n-Element-Tree"><a href="Element_tree.html">Element Tree</a></li>
									</ul>
					</div>
		</div>
			<div id="p-search" class="portlet" role="search">
			<h3><label for="searchInput">Search</label></h3>

			<div id="searchBody" class="pBody">
				<form action="http://wiki.localhost/index.php" id="searchform">
					<input type='hidden' name="title" value="Special:Search"/>
					<input type="search" name="search" placeholder="Search" title="Search Multi Theft Auto: Wiki [f]" accesskey="f" id="searchInput"/>
					<input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchGoButton" class="searchButton"/>&#160;
						<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton"/>
				</form>

							</div>
		</div>
			<div class="portlet" id="p-tb" role="navigation">
			<h3>Tools</h3>

			<div class="pBody">
				<ul>
											<li id="t-whatlinkshere"><a href="Special_WhatLinksHere/DbQuery.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
											<li id="t-recentchangeslinked"><a href="Special_RecentChangesLinked/DbQuery.html" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
											<li id="t-specialpages"><a href="Special_SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
											<li id="t-print"><a href="http://wiki.localhost/index.php?title=DbQuery&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
											<li id="t-permalink"><a href="http://wiki.localhost/index.php?title=DbQuery&amp;oldid=46292" title="Permanent link to this revision of the page">Permanent link</a></li>
											<li id="t-info"><a href="http://wiki.localhost/index.php?title=DbQuery&amp;action=info" title="More information about this page">Page information</a></li>
									</ul>
							</div>
		</div>
			</div><!-- end of the left (by default at least) column -->
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
						<div id="f-copyrightico">
									<a href="http://www.gnu.org/copyleft/fdl.html"><img src="http://wiki.localhost/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.2" width="88" height="31"/></a>
							</div>
					<div id="f-poweredbyico">
									<a href="http://www.mediawiki.org/"><img src="http://wiki.localhost/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"/></a>
							</div>
					<ul id="f-list">
									<li id="lastmod"> This page was last modified on 4 January 2016, at 22:41.</li>
									<li id="copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.2</a> unless otherwise noted.</li>
									<li id="privacy"><a href="Multi_Theft_Auto__Wiki_Privacy_policy.html" title="Multi Theft Auto: Wiki:Privacy policy">Privacy policy</a></li>
									<li id="about"><a href="Multi_Theft_Auto__Wiki_About.html" title="Multi Theft Auto: Wiki:About">About Multi Theft Auto: Wiki</a></li>
									<li id="disclaimer"><a href="Multi_Theft_Auto__Wiki_General_disclaimer.html" title="Multi Theft Auto: Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
		</div>
		</div>
		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.loader.state({"user":"ready","user.groups":"ready"});mw.loader.load(["mediawiki.action.view.postEdit","site","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","ext.GoogleCodePrettify"]);});</script>
<script src="http://wiki.localhost/extensions/_MTAThemeExtensions/main.js?303"></script><script src="http://wiki.localhost/extensions/_MTAThemeExtensions/topmenu.js?303"></script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":68});});</script></body></html>
